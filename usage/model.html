<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Data model · OpenCTI documentation</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;Even if the OpenCTI data model is based on &lt;a href=&quot;https://oasis-open.github.io/cti-documentation/stix/intro&quot;&gt;STIX2&lt;/a&gt; and you are already familiar with it, you should read this section to understand how we have implemented this model and what make the OpenCTI platform unique (even if some features described here are not available in the frontend yet).&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Data model · OpenCTI documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://opencti-platform.github.io/docs/"/><meta property="og:description" content="&lt;p&gt;Even if the OpenCTI data model is based on &lt;a href=&quot;https://oasis-open.github.io/cti-documentation/stix/intro&quot;&gt;STIX2&lt;/a&gt; and you are already familiar with it, you should read this section to understand how we have implemented this model and what make the OpenCTI platform unique (even if some features described here are not available in the frontend yet).&lt;/p&gt;
"/><meta property="og:image" content="https://opencti-platform.github.io/docs/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://opencti-platform.github.io/docs/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/docs/img/logo.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/docs/js/scrollSpy.js"></script><link rel="stylesheet" href="/docs/css/prism.css"/><link rel="stylesheet" href="/docs/css/main.css"/><script src="/docs/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/docs/"><img class="logo" src="/docs/img/logo_header.png" alt="OpenCTI documentation"/><h2 class="headerTitleWithLogo">OpenCTI documentation</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/getting-started/introduction" target="_self">Documentation</a></li><li class=""><a href="https://slack.luatix.org" target="_self">Help</a></li><li class=""><a href="https://www.github.com/OpenCTI-Platform/opencti" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Usage</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Getting Started</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/getting-started/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/getting-started/architecture">Architecture</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Installation</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/installation/docker">Using Docker</a></li><li class="navListItem"><a class="navItem" href="/docs/installation/manual">Manual deployment</a></li><li class="navListItem"><a class="navItem" href="/docs/development/installation">Development environment</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Usage</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/usage/overview">Overview</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/usage/model">Data model</a></li><li class="navListItem"><a class="navItem" href="/docs/usage/reports-create">Create reports</a></li><li class="navListItem"><a class="navItem" href="/docs/usage/report-knowledge">Add knowledge to a report</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/reference/relations">Relations between things</a></li><li class="navListItem"><a class="navItem" href="/docs/reference/inferences">Inferred relations</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Data model</h1></header><article><div><span><p>Even if the OpenCTI data model is based on <a href="https://oasis-open.github.io/cti-documentation/stix/intro">STIX2</a> and you are already familiar with it, you should read this section to understand how we have implemented this model and what make the OpenCTI platform unique (even if some features described here are not available in the frontend yet).</p>
<h2><a class="anchor" aria-hidden="true" id="the-hypergraph"></a><a href="#the-hypergraph" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The hypergraph</h2>
<p>The OpenCTI data model needs a database that implements the <a href="https://en.wikipedia.org/wiki/Hypergraph">hypergraph theory</a>. We made this choice because we want, now and in the future, to be able to modelize the full understanding of a threat or a campaign without limitation. We selected <a href="http://grakn.ai">Grakn Core Server</a> as our main database backend because it really fits our needs to implement the model we designed. Here are some useful information about the OpenCTI graph model.</p>
<h3><a class="anchor" aria-hidden="true" id="hierarchical-entities"></a><a href="#hierarchical-entities" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Hierarchical entities</h3>
<p>Entities are not all at the same level, we have implemented both abstract entities (normal entities inheritates of their attributes) and sub-entities (that inheritates attributes from other entities). So for instance, we have an entity named <code>Stix-Domain-Entity</code> that has a <code>name</code> and a <code>description</code>, and an other entity <code>Tool</code> which is a child of <code>Stix-Domain-Entity</code> and has the specific attribute <code>tool_version</code>.</p>
<pre><code class="hljs">Stix-Domain-Entity <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">entity</span>,
  <span class="hljs-title">abstract</span>,
  <span class="hljs-title">has</span> <span class="hljs-title">name</span>,
  <span class="hljs-title">has</span> <span class="hljs-title">description</span></span>;
</code></pre>
<pre><code class="hljs">Tool <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">Stix</span>-<span class="hljs-title">Domain</span>-<span class="hljs-title">Entity</span>,
  <span class="hljs-title">has</span> <span class="hljs-title">tool_version</span></span>;
</code></pre>
<p>This allow database query to select all <code>Stix-Domain-Entity</code> instances if needed, or just <code>Tool</code> instances.</p>
<h3><a class="anchor" aria-hidden="true" id="relations"></a><a href="#relations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Relations</h3>
<p>Entities could be linked by some relations. A relation is a connection between any number of entities, identified with specific <code>roles</code> that defined a relation:</p>
<pre><code class="hljs">origin <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">role</span></span>;
attribution <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">role</span></span>;

attributed-to <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">relation</span>,
  <span class="hljs-title">relates</span> <span class="hljs-title">origin</span>,
  <span class="hljs-title">relates</span> <span class="hljs-title">attribution</span></span>;

Threat-Actor <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">Stix</span>-<span class="hljs-title">Domain</span>-<span class="hljs-title">Entity</span>,
  <span class="hljs-title">plays</span> <span class="hljs-title">origin</span></span>;

Intrusion-Set <span class="hljs-function"><span class="hljs-keyword">sub</span> <span class="hljs-title">Stix</span>-<span class="hljs-title">Domain</span>-<span class="hljs-title">Entity</span>,
  <span class="hljs-title">plays</span> <span class="hljs-title">attribution</span></span>;
</code></pre>
<p>This means that you can have this relation:</p>
<table>
<thead>
<tr><th>Source (<em>role</em>)</th><th>Relation type</th><th>Target (<em>role</em>)</th></tr>
</thead>
<tbody>
<tr><td>Intrusion Set (<em>attribution</em>)</td><td><strong>attributed-to</strong></td><td>Threat Actor (<em>origin</em>)</td></tr>
</tbody>
</table>
<p>To know more about available relations, please read the <a href="../reference/relations">dedicated section</a>.</p>
<h3></h3>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 7/1/2019 by Samuel Hassine</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/usage/overview"><span class="arrow-prev">← </span><span>Overview</span></a><a class="docs-next button" href="/docs/usage/reports-create"><span>Create reports</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#the-hypergraph">The hypergraph</a><ul class="toc-headings"><li><a href="#hierarchical-entities">Hierarchical entities</a></li><li><a href="#relations">Relations</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/docs/" class="nav-home"><img src="/docs/img/logo.png" alt="OpenCTI documentation" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/installation/installation-docker">Install using Docker</a><a href="/docs/usage/usage-introduction">Usage introduction</a><a href="/docs/development/development-docker">Development environment</a></div><div><h5>Community</h5><a href="https://demo.opencti.io">Demonstration</a><a href="http://stackoverflow.com/questions/tagged/OpenCTI" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://slack.luatix.org/">Slack</a><a href="https://twitter.com/LuatixHQ" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://www.luatix.org/en/blog/">Blog</a><a href="https://github.com/OpenCTI-Platform">GitHub</a><a class="github-button" href="https://github.com/OpenCTI-Platform/opencti" data-icon="octicon-star" data-count-href="/OpenCTI-Platform/opencti/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 OpenCTI</section></footer></div></body></html>